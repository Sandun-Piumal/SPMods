<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Smart AI - Modern AI Chat Interface powered by Gemini">
    <meta name="keywords" content="AI, Chat, Gemini, Sinhala, English, Assistant">
    <title>Smart AI - Modern Chat Interface (Gemini)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #8B5CF6;
            --primary-dark: #7C3AED;
            --primary-light: #A78BFA;
            --secondary: #EC4899;
            --accent: #06D6A0;
            --dark: #1E1B2E;
            --dark-light: #2A2640;
            --text: #F8FAFC;
            --text-light: #CBD5E1;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --gradient-1: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%);
            --gradient-2: linear-gradient(135deg, #06D6A0 0%, #3B82F6 100%);
            --gradient-3: linear-gradient(135deg, #F59E0B 0%, #EC4899 100%);
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        [data-theme="light"] {
            --dark: #F8FAFC;
            --dark-light: #E2E8F0;
            --text: #1E293B;
            --text-light: #475569;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        body {
            background: linear-gradient(-45deg, #1E1B2E, #2A2640, #3B3056, #1E1B2E);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            transition: all 0.3s ease;
        }

        [data-theme="light"] body {
            background: linear-gradient(-45deg, #E2E8F0, #CBD5E1, #94A3B8, #E2E8F0);
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Auth Container Styles */
        .auth-container {
            width: 100%;
            max-width: 450px;
            background: rgba(30, 27, 46, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 40px 30px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        [data-theme="light"] .auth-container {
            background: rgba(248, 250, 252, 0.9);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-logo {
            width: 80px;
            height: 80px;
            background: var(--gradient-1);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 36px;
            box-shadow: var(--shadow-light);
        }

        .auth-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-subtitle {
            color: var(--text-light);
            font-size: 16px;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }

        .form-input {
            padding: 15px 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text);
            font-size: 16px;
            transition: all 0.3s ease;
            outline: none;
        }

        [data-theme="light"] .form-input {
            border: 1px solid rgba(0, 0, 0, 0.1);
            background: rgba(0, 0, 0, 0.05);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        .auth-button {
            padding: 15px 20px;
            border-radius: 12px;
            border: none;
            background: var(--gradient-1);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            margin-top: 10px;
        }

        .auth-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5);
        }

        .auth-button:active {
            transform: translateY(0);
        }

        .auth-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: var(--text-light);
        }

        .auth-link {
            color: var(--primary);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .auth-link:hover {
            text-decoration: underline;
        }

        .forgot-password {
            text-align: center;
            margin-top: 10px;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(239, 68, 68, 0.3);
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(16, 185, 129, 0.3);
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        /* Chat App Styles */
        .chat-app {
            width: 100%;
            max-width: 1200px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: var(--shadow);
            background: rgba(30, 27, 46, 0.8);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            display: none;
        }

        [data-theme="light"] .chat-app {
            background: rgba(248, 250, 252, 0.9);
        }

        /* Header */
        .header {
            background: var(--dark);
            padding: 15px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            flex-shrink: 0;
            min-height: 80px;
        }

        [data-theme="light"] .header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeInDown 0.6s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-1);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-light);
        }

        .logo-text h1 {
            font-size: 28px;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text p {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 2px;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Theme Toggle */
        .theme-toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 12px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        [data-theme="light"] .theme-toggle-container {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .theme-toggle-container:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        [data-theme="light"] .theme-toggle-container:hover {
            background: rgba(0, 0, 0, 0.08);
        }

        .theme-toggle {
            position: relative;
            width: 50px;
            height: 26px;
        }

        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--dark-light);
            border-radius: 34px;
            transition: .4s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 6px;
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background: var(--primary);
            border-radius: 50%;
            transition: .4s;
            z-index: 2;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked + .theme-slider:before {
            transform: translateX(24px);
            background: #F59E0B;
        }

        .theme-icon {
            font-size: 10px;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .sun-icon {
            color: #F59E0B;
        }

        .moon-icon {
            color: #CBD5E1;
        }

        [data-theme="light"] .moon-icon {
            color: #475569;
        }

        .theme-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-light);
            white-space: nowrap;
        }

        /* Language Switcher */
        .language-switcher {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 4px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        [data-theme="light"] .language-switcher {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .lang-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }

        .lang-btn.active {
            background: var(--gradient-1);
            box-shadow: var(--shadow-light);
        }

        .lang-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }

        [data-theme="light"] .lang-btn:hover:not(.active) {
            background: rgba(0, 0, 0, 0.05);
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        [data-theme="light"] .user-profile {
            background: rgba(0, 0, 0, 0.05);
        }

        .user-profile:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        [data-theme="light"] .user-profile:hover {
            background: rgba(0, 0, 0, 0.08);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: var(--shadow-light);
        }

        .user-info h3 {
            font-size: 15px;
            margin-bottom: 3px;
        }

        .user-info p {
            font-size: 12px;
            color: var(--text-light);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-indicator i {
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Logout Button */
        .logout-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--dark-light);
            transition: all 0.3s ease;
            min-height: 0;
        }

        /* Messages Container */
        .chat-messages {
            flex: 1;
            padding: 20px 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
            min-height: 0;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        [data-theme="light"] .chat-messages::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        [data-theme="light"] .chat-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .message {
            max-width: 75%;
            padding: 18px 22px;
            border-radius: 18px;
            line-height: 1.6;
            position: relative;
            animation: messageSlide 0.4s ease-out;
            box-shadow: var(--shadow-light);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .user-message {
            align-self: flex-end;
            background: var(--gradient-1);
            color: var(--text);
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 5px;
        }

        [data-theme="light"] .ai-message {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 600;
        }

        .message-avatar {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .user-message .message-avatar {
            background: rgba(255, 255, 255, 0.2);
        }

        .ai-message .message-avatar {
            background: var(--gradient-2);
        }

        .message-content {
            font-size: 15px;
            line-height: 1.6;
        }

        .message-time {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Input Area */
        .chat-input-container {
            padding: 20px 30px;
            background: rgba(30, 27, 46, 0.8);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        [data-theme="light"] .chat-input-container {
            background: rgba(248, 250, 252, 0.9);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        [data-theme="light"] .chat-input-wrapper {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .chat-input-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
        }

        .chat-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            outline: none;
            font-size: 16px;
            resize: none;
            max-height: 120px;
            min-height: 50px;
            line-height: 1.6;
            background: transparent;
            color: var(--text);
            font-family: inherit;
        }

        .chat-input::placeholder {
            color: var(--text-light);
        }

        .send-button {
            background: var(--gradient-1);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            flex-shrink: 0;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5);
        }

        .send-button:active:not(:disabled) {
            transform: translateY(-1px) scale(1.02);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .send-button i {
            font-size: 18px;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.05);
            padding: 18px 22px;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            box-shadow: var(--shadow-light);
            margin-bottom: 10px;
        }

        [data-theme="light"] .typing-indicator {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .typing-dots {
            display: inline-flex;
            gap: 6px;
            margin-left: 10px;
        }

        .typing-dots span {
            height: 8px;
            width: 8px;
            border-radius: 50%;
            background: var(--gradient-1);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: 0s; }
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.7; }
            30% { transform: translateY(-5px); opacity: 1; }
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 40px 30px;
            animation: fadeIn 0.8s ease-out;
        }

        .welcome-icon {
            font-size: 80px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 25px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .welcome-message h2 {
            font-size: 32px;
            margin-bottom: 15px;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .welcome-message p {
            color: var(--text-light);
            font-size: 18px;
            line-height: 1.6;
        }

        /* New Features */
        .feature-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .feature-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text);
            padding: 10px 16px;
            border-radius: 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        [data-theme="light"] .feature-btn {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        [data-theme="light"] .feature-btn:hover {
            background: rgba(0, 0, 0, 0.08);
        }

        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: flex-end;
        }

        .message-action-btn {
            background: transparent;
            border: none;
            color: var(--text-light);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .message-action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
        }

        [data-theme="light"] .message-action-btn:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: var(--error);
        }

        .notification.warning {
            background: var(--warning);
        }

        /* Footer */
        .footer {
            margin-top: 30px;
            padding: 20px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: transparent;
        }

        [data-theme="light"] .footer {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .chat-footer {
            margin-top: 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--dark);
            padding: 15px 0;
        }

        [data-theme="light"] .chat-footer {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            background: var(--dark);
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            text-align: center;
        }

        .footer-copyright {
            color: var(--text-light);
            font-size: 12px;
            line-height: 1.5;
        }

        .footer-copyright p {
            margin: 2px 0;
        }

        .design-credit {
            font-size: 11px;
            opacity: 0.8;
            font-style: italic;
        }

        /* Responsive Design */
        @media (max-width: 968px) {
            .chat-app {
                height: 95vh;
            }
            
            .header {
                padding: 12px 20px;
                min-height: 70px;
            }
            
            .logo-text h1 {
                font-size: 24px;
            }
            
            .logo-text p {
                font-size: 12px;
            }
            
            .header-controls {
                gap: 10px;
            }
            
            .user-info h3 {
                font-size: 14px;
            }
            
            .user-info p {
                font-size: 11px;
            }
            
            .status-indicator {
                font-size: 12px;
                padding: 6px 12px;
            }
            
            .chat-messages {
                padding: 15px 20px;
            }
            
            .message {
                max-width: 85%;
                padding: 16px 20px;
            }
            
            .chat-input-container {
                padding: 15px 20px;
            }
            
            .welcome-message {
                padding: 30px 20px;
            }
            
            .welcome-icon {
                font-size: 60px;
            }
            
            .welcome-message h2 {
                font-size: 24px;
            }
            
            .welcome-message p {
                font-size: 16px;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
                min-height: auto;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo-section {
                width: 100%;
                justify-content: center;
            }
            
            .header-controls {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .user-profile {
                display: none;
            }
            
            .theme-toggle-container {
                order: -1;
            }
        }
        
        @media (max-width: 480px) {
            .auth-container {
                padding: 30px 20px;
            }
            
            .auth-logo {
                width: 60px;
                height: 60px;
                font-size: 28px;
            }
            
            .auth-title {
                font-size: 24px;
            }
            
            .header {
                padding: 10px 15px;
            }
            
            .logo-text h1 {
                font-size: 20px;
            }
            
            .logo-icon {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .user-profile {
                padding: 6px 12px;
            }
            
            .user-avatar {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
            
            .lang-btn {
                padding: 6px 10px;
                font-size: 12px;
            }
            
            .theme-toggle {
                width: 45px;
                height: 24px;
            }
            
            .theme-slider:before {
                height: 18px;
                width: 18px;
            }
            
            input:checked + .theme-slider:before {
                transform: translateX(21px);
            }
            
            .message {
                max-width: 90%;
                font-size: 14px;
            }
            
            .send-button {
                width: 45px;
                height: 45px;
            }
            
            .theme-label {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Container -->
    <div class="auth-container" id="authContainer">
        <div class="auth-header">
            <div class="auth-logo">
                <i class="fas fa-robot"></i>
            </div>
            <h1 class="auth-title" id="authTitle">Smart AI</h1>
            <p class="auth-subtitle" id="authSubtitle">Powered by Gemini AI</p>
        </div>
        
        <!-- Login Form -->
        <form class="auth-form" id="loginForm">
            <div class="form-group">
                <label class="form-label" id="emailLabel">Email</label>
                <input type="email" class="form-input" id="loginEmail" placeholder="Your email" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="passwordLabel">Password</label>
                <input type="password" class="form-input" id="loginPassword" placeholder="Your password" required>
            </div>
            <button type="submit" class="auth-button" id="loginButton">Login</button>
            <div class="error-message" id="loginError"></div>
            
            <div class="forgot-password">
                <span class="auth-link" id="forgotPassword">Forgot Password?</span>
            </div>
            
            <div class="auth-switch">
                <span id="noAccount">Don't have an account?</span>
                <span class="auth-link" id="showSignup">Sign Up</span>
            </div>
        </form>
        
        <!-- Signup Form -->
        <form class="auth-form" id="signupForm" style="display: none;">
            <div class="form-group">
                <label class="form-label" id="nameLabel">Name</label>
                <input type="text" class="form-input" id="signupName" placeholder="Your name" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="signupEmailLabel">Email</label>
                <input type="email" class="form-input" id="signupEmail" placeholder="Your email" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="signupPasswordLabel">Password</label>
                <input type="password" class="form-input" id="signupPassword" placeholder="At least 6 characters" minlength="6" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="confirmPasswordLabel">Confirm Password</label>
                <input type="password" class="form-input" id="confirmPassword" placeholder="Re-enter your password" required>
            </div>
            <button type="submit" class="auth-button" id="signupButton">Sign Up</button>
            <div class="error-message" id="signupError"></div>
            <div class="success-message" id="signupSuccess"></div>
            <div class="auth-switch">
                <span id="haveAccount">Already have an account?</span>
                <span class="auth-link" id="showLogin">Login</span>
            </div>
        </form>

        <!-- Forgot Password Form -->
        <form class="auth-form" id="forgotPasswordForm" style="display: none;">
            <div class="form-group">
                <label class="form-label" id="forgotEmailLabel">Email</label>
                <input type="email" class="form-input" id="forgotEmail" placeholder="Your email address" required>
            </div>
            <button type="submit" class="auth-button" id="resetPasswordButton">Reset Password</button>
            <div class="error-message" id="forgotError"></div>
            <div class="success-message" id="forgotSuccess"></div>
            <div class="auth-switch">
                <span>Remember your password?</span>
                <span class="auth-link" id="backToLogin">Back to Login</span>
            </div>
        </form>

        <div class="footer">
            <div class="footer-content">
                <div class="footer-copyright">
                    <p id="copyrightText">Copyright ¬© 2025 SPMods. All Rights Reserved.</p>
                    <p class="design-credit" id="designCredit">Developed: Sandun Piumal</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chat Application -->
    <div class="chat-app" id="chatApp">
        <div class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="logo-text">
                        <h1 id="logoTitle">Smart AI</h1>
                        <p id="headerSubtitle">Powered by Gemini AI</p>
                    </div>
                </div>
                
                <div class="header-controls">
                    <div class="theme-toggle-container">
                        <span class="theme-label" id="themeLabel">‡∂Ö‡∂≥‡∑î‡∂ª‡∑î</span>
                        <div class="theme-toggle">
                            <input type="checkbox" id="themeToggle">
                            <label class="theme-slider" for="themeToggle">
                                <i class="fas fa-sun theme-icon sun-icon"></i>
                                <i class="fas fa-moon theme-icon moon-icon"></i>
                            </label>
                        </div>
                    </div>
                    
                    <div class="language-switcher">
                        <button class="lang-btn active" id="sinhalaBtn">
                            <i class="fas fa-language"></i>
                            <span>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</span>
                        </button>
                        <button class="lang-btn" id="englishBtn">
                            <i class="fas fa-globe"></i>
                            <span>English</span>
                        </button>
                    </div>
                    
                    <div class="status-indicator">
                        <i class="fas fa-check-circle"></i>
                        <span id="statusText">Online</span>
                    </div>
                    
                    <div class="user-profile">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <h3 id="username">‡∂¥‡∂ª‡∑í‡∑Å‡∑ì‡∂Ω‡∂ö</h3>
                            <p id="userStatus">Online</p>
                        </div>
                    </div>

                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span id="logoutText">‡∂¥‡∑í‡∂ß‡∑Ä‡∑ì‡∂∏</span>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="chat-area">
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <div class="welcome-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <h2 id="welcomeTitle">‡∂±‡∑Ä Model ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∂∫‡∑è‡∑Ä‡∂≠‡∑ä‡∂ö‡∑è‡∂Ω‡∑ì‡∂± ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì! ‚ú®</h2>
                    <p id="welcomeText">
                        Gemini AI Model ‡∑É‡∂∏‡∂ü ‡∑Ä‡∑ê‡∂© ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß ‡∑É‡∑ñ‡∂Ø‡∑è‡∂±‡∂∏‡∑ä!<br> ‡∂î‡∂∂‡∂ú‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫ ‡∂¥‡∑Ñ‡∂≠‡∑í‡∂±‡∑ä ‡∂ß‡∂∫‡∑í‡∂¥‡∑ä ‡∂ö‡∂ª Enter ‡∂î‡∂∂‡∂±‡∑ä‡∂± üöÄ
                    </p>
                    <div class="feature-buttons">
                        <button class="feature-btn" id="clearChatBtn">
                            <i class="fas fa-trash"></i>
                            <span id="clearChatText">‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø‡∂∫ ‡∑Ñ‡∑í‡∑É‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</span>
                        </button>
                        <button class="feature-btn" id="exportChatBtn">
                            <i class="fas fa-download"></i>
                            <span id="exportChatText">‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø‡∂∫ ‡∂∂‡∑è‡∂ú‡∂±‡∑ä‡∂±</span>
                        </button>
                        <button class="feature-btn" id="suggestionsBtn">
                            <i class="fas fa-lightbulb"></i>
                            <span id="suggestionsText">‡∂∫‡∑ù‡∂¢‡∂±‡∑è</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="typing-indicator" id="typingIndicator">
                <i class="fas fa-robot"></i> <span id="typingText">Smart AI ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂†‡∑è‡∂ª ‡∑É‡∂ö‡∑É‡∂∏‡∑í‡∂±‡∑ä</span>
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea class="chat-input" id="messageInput" placeholder="‡∂î‡∂∂‡∂ú‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫ ‡∂∏‡∑ô‡∂≠‡∑ê‡∂± ‡∂ß‡∂∫‡∑í‡∂¥‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±..." rows="1"></textarea>
                    <button class="send-button" id="sendButton">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="footer chat-footer">
            <div class="footer-content">
                <div class="footer-copyright">
                    <p id="footerCopyright">Copyright ¬© 2025 SPMods. All Rights Reserved.</p>
                    <p class="design-credit" id="footerDesign">Developed: Sandun Piumal</p>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Operation completed successfully</span>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAP7X4CZh-E5S9Qfpi-hWxDO1R_PvXC8yg",
            authDomain: "smart-ai-chat-app.firebaseapp.com",
            projectId: "smart-ai-chat-app",
            storageBucket: "smart-ai-chat-app.firebasestorage.app",
            messagingSenderId: "195723763663",
            appId: "1:195723763663:web:0892e6392eb77c15813cba",
            measurementId: "G-SWRB896B6Y"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // Language content
        const languageContent = {
            sinhala: {
                                authTitle: "Smart AI",
                authSubtitle: "Powered by Gemini AI",
                emailLabel: "Email",
                passwordLabel: "Password",
                nameLabel: "Name",
                confirmPasswordLabel: "Confirm Password",
                loginButton: "Login",
                signupButton: "Sign Up",
                noAccount: "Don't have an account?",
                haveAccount: "Already have an account?",
                showSignup: "Sign Up",
                showLogin: "Login",
                forgotPassword: "Forgot Password?",
                resetPasswordButton: "Reset Password",
                backToLogin: "Back to Login",
                rememberPassword: "Remember your password?",
                logoTitle: "Smart AI",
                headerSubtitle: "Powered by Gemini AI",
                username: "User",
                userStatus: "Online",
                statusText: "Online",
                logoutText: "Logout",
                welcomeTitle: "New Model Successfully Updated! ‚ú®",
                welcomeText: "Ready to work with Gemini AI Model!<br>Type your question below and press Enter üöÄ",
                typingText: "Smart AI is preparing response",
                inputPlaceholder: "Type your question here...",
                themeLabelDark: "Dark",
                themeLabelLight: "Light",
                clearChatText: "Clear Chat",
                exportChatText: "Export Chat",
                suggestionsText: "Suggestions",
                copyright: "Copyright ¬© 2025 SPMods. All Rights Reserved.",
                designCredit: "Developed: Sandun Piumal",
                userLabel: "You",
                aiLabel: "Smart AI",
                systemPrompt: `‡∂î‡∂∂ Smart AI ‡∂±‡∂∏‡∑ä ‡∂ã‡∂¥‡∂ö‡∑è‡∂ª‡∂ö AI ‡∑Ä‡∑ö. ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∑Ä‡∂Ω‡∂ß ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±. 
                ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∑É‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª‡∑è‡∂≠‡∑ä‡∂∏‡∂ö, ‡∂ã‡∂¥‡∂∫‡∑ù‡∂ú‡∑ì ‡∑É‡∑Ñ ‡∂∏‡∑í‡∂≠‡∑ä‚Äç‡∂ª‡∑Å‡∑ì‡∂Ω‡∑ì ‡∑Ä‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∫. 
                ‡∂ö‡∑ö‡∂≠‡∂∫, ‡∂≠‡∑è‡∂ö‡∑ä‡∑Ç‡∂´‡∂∫, ‡∑Ä‡∑í‡∂Ø‡∑ä‚Äç‡∂∫‡∑è‡∑Ä, ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫ ‡∑É‡∑Ñ ‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∂Ø‡∑ê‡∂±‡∑î‡∂∏ ‡∂¥‡∑í‡∑Ö‡∑í‡∂∂‡∂≥ ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±.`
            },
            english: {
                authTitle: "Smart AI",
                authSubtitle: "Powered by Gemini AI",
                emailLabel: "Email",
                passwordLabel: "Password",
                nameLabel: "Name",
                confirmPasswordLabel: "Confirm Password",
                loginButton: "Login",
                signupButton: "Sign Up",
                noAccount: "Don't have an account?",
                haveAccount: "Already have an account?",
                showSignup: "Sign Up",
                showLogin: "Login",
                forgotPassword: "Forgot Password?",
                resetPasswordButton: "Reset Password",
                backToLogin: "Back to Login",
                rememberPassword: "Remember your password?",
                logoTitle: "Smart AI",
                headerSubtitle: "Powered by Gemini AI",
                username: "User",
                userStatus: "Online",
                statusText: "Online",
                logoutText: "Logout",
                welcomeTitle: "New Model Successfully Updated! ‚ú®",
                welcomeText: "Ready to work with Gemini AI Model!<br>Type your question below and press Enter üöÄ",
                typingText: "Smart AI is preparing response",
                inputPlaceholder: "Type your question here...",
                themeLabelDark: "Dark",
                themeLabelLight: "Light",
                clearChatText: "Clear Chat",
                exportChatText: "Export Chat",
                suggestionsText: "Suggestions",
                copyright: "Copyright ¬© 2025 SPMods. All Rights Reserved.",
                designCredit: "Developed: Sandun Piumal",
                userLabel: "You",
                aiLabel: "Smart AI",
                systemPrompt: `You are Smart AI, a helpful AI assistant. Respond to all questions in English.
                Responses should be detailed, helpful and friendly.
                Provide detailed answers for questions about code, technology, science, history and general knowledge.`
            }
        };

        // Current state
        let currentLanguage = 'sinhala';
        let currentTheme = 'dark';
        let chatHistory = [];

        // Gemini API Key
        const GOOGLE_AI_API_KEY = 'AIzaSyAJhruzaSUiKhP8GP7ZLg2h25GBTSKq1gs';

        // DOM Elements
        const authContainer = document.getElementById('authContainer');
        const chatApp = document.getElementById('chatApp');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const forgotPasswordForm = document.getElementById('forgotPasswordForm');
        const showSignup = document.getElementById('showSignup');
        const showLogin = document.getElementById('showLogin');
        const forgotPassword = document.getElementById('forgotPassword');
        const backToLogin = document.getElementById('backToLogin');
        const loginError = document.getElementById('loginError');
        const signupError = document.getElementById('signupError');
        const signupSuccess = document.getElementById('signupSuccess');
        const forgotError = document.getElementById('forgotError');
        const forgotSuccess = document.getElementById('forgotSuccess');
        const logoutBtn = document.getElementById('logoutBtn');
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const themeToggle = document.getElementById('themeToggle');
        const themeLabel = document.getElementById('themeLabel');
        const sinhalaBtn = document.getElementById('sinhalaBtn');
        const englishBtn = document.getElementById('englishBtn');
        const clearChatBtn = document.getElementById('clearChatBtn');
        const exportChatBtn = document.getElementById('exportChatBtn');
        const suggestionsBtn = document.getElementById('suggestionsBtn');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');

        // Check authentication state
        auth.onAuthStateChanged((user) => {
            if (user) {
                showChatApp();
                updateUserProfile(user);
            } else {
                showAuthContainer();
            }
        });

        // Update user profile
        function updateUserProfile(user) {
            const usernameElement = document.getElementById('username');
            if (user.displayName) {
                usernameElement.textContent = user.displayName;
            } else {
                usernameElement.textContent = user.email.split('@')[0];
            }
        }

        // Show auth container
        function showAuthContainer() {
            authContainer.style.display = 'block';
            chatApp.style.display = 'none';
            showLoginForm();
        }

        // Show chat app
        function showChatApp() {
            authContainer.style.display = 'none';
            chatApp.style.display = 'flex';
            messageInput.focus();
        }

        // Show login form
        function showLoginForm() {
            loginForm.style.display = 'flex';
            signupForm.style.display = 'none';
            forgotPasswordForm.style.display = 'none';
            loginError.style.display = 'none';
            signupError.style.display = 'none';
            signupSuccess.style.display = 'none';
            forgotError.style.display = 'none';
            forgotSuccess.style.display = 'none';
        }

        // Show signup form
        function showSignupForm() {
            loginForm.style.display = 'none';
            signupForm.style.display = 'flex';
            forgotPasswordForm.style.display = 'none';
            loginError.style.display = 'none';
            signupError.style.display = 'none';
            signupSuccess.style.display = 'none';
            forgotError.style.display = 'none';
            forgotSuccess.style.display = 'none';
        }

        // Show forgot password form
        function showForgotPasswordForm() {
            loginForm.style.display = 'none';
            signupForm.style.display = 'none';
            forgotPasswordForm.style.display = 'flex';
            loginError.style.display = 'none';
            signupError.style.display = 'none';
            signupSuccess.style.display = 'none';
            forgotError.style.display = 'none';
            forgotSuccess.style.display = 'none';
        }

        // Show notification
        function showNotification(message, type = 'success') {
            notification.className = 'notification';
            notification.classList.add(type);
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Login form
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            loginError.style.display = 'none';
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    loginForm.reset();
                    showNotification(
                        currentLanguage === 'sinhala' ? '‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∂¥‡∑í‡∑Ä‡∑í‡∑É‡∑í‡∂∫‡∑è!' : 'Successfully logged in!',
                        'success'
                    );
                })
                .catch((error) => {
                    loginError.textContent = currentLanguage === 'sinhala' 
                        ? '‡∂¥‡∑í‡∑Ä‡∑í‡∑É‡∑î‡∂∏ ‡∂Ö‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂î‡∂∂‡∂ú‡∑ö ‡∂≠‡∑ú‡∂ª‡∂≠‡∑î‡∂ª‡∑î ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.' 
                        : 'Login failed. Please check your credentials.';
                    loginError.style.display = 'block';
                });
        });

        // Signup form
        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            signupError.style.display = 'none';
            signupSuccess.style.display = 'none';
            
            if (password !== confirmPassword) {
                signupError.textContent = currentLanguage === 'sinhala' 
                    ? '‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø ‡∂ú‡∑ê‡∂Ω‡∂¥‡∑ô‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∂≠' 
                    : 'Passwords do not match';
                signupError.style.display = 'block';
                return;
            }
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    return userCredential.user.updateProfile({
                        displayName: name
                    });
                })
                .then(() => {
                    signupSuccess.textContent = currentLanguage === 'sinhala' 
                        ? '‡∂Ω‡∑í‡∂∫‡∑è‡∂¥‡∂Ø‡∑í‡∂Ç‡∂†‡∑í‡∂∫ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í!' 
                        : 'Registration successful!';
                    signupSuccess.style.display = 'block';
                    signupForm.reset();
                    showNotification(
                        currentLanguage === 'sinhala' ? '‡∂Ω‡∑í‡∂∫‡∑è‡∂¥‡∂Ø‡∑í‡∂Ç‡∂†‡∑í‡∂∫ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í!' : 'Registration successful!',
                        'success'
                    );
                })
                .catch((error) => {
                    signupError.textContent = currentLanguage === 'sinhala' 
                        ? '‡∂Ω‡∑í‡∂∫‡∑è‡∂¥‡∂Ø‡∑í‡∂Ç‡∂†‡∑í‡∂∫ ‡∂Ö‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂ã‡∂≠‡∑ä‡∑É‡∑è‡∑Ñ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.' 
                        : 'Registration failed. Please try again.';
                    signupError.style.display = 'block';
                });
        });

        // Forgot password form
        forgotPasswordForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;
            
            forgotError.style.display = 'none';
            forgotSuccess.style.display = 'none';
            
            auth.sendPasswordResetEmail(email)
                .then(() => {
                    forgotSuccess.textContent = currentLanguage === 'sinhala' 
                        ? '‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø ‡∂∫‡∑Ö‡∑í ‡∑É‡∑ê‡∂ö‡∑É‡∑î‡∂∏‡∑ä ‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∫‡∑Ä‡∂± ‡∂Ω‡∂Ø‡∑ì! ‡∂î‡∂∂‡∂ú‡∑ö ‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.' 
                        : 'Password reset email sent! Check your inbox.';
                    forgotSuccess.style.display = 'block';
                    forgotPasswordForm.reset();
                })
                .catch((error) => {
                    forgotError.textContent = currentLanguage === 'sinhala' 
                        ? '‡∂∫‡∑Ö‡∑í ‡∑É‡∑ê‡∂ö‡∑É‡∑î‡∂∏‡∑ä ‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä ‡∂∫‡∑ê‡∑Ä‡∑ì‡∂∏ ‡∂Ö‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂î‡∂∂‡∂ú‡∑ö ‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä ‡∂Ω‡∑í‡∂¥‡∑í‡∂±‡∂∫ ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.' 
                        : 'Failed to send reset email. Please check your email address.';
                    forgotError.style.display = 'block';
                });
        });

        // Form switching
        showSignup.addEventListener('click', showSignupForm);
        showLogin.addEventListener('click', showLoginForm);
        forgotPassword.addEventListener('click', showForgotPasswordForm);
        backToLogin.addEventListener('click', showLoginForm);

        // Logout button
        logoutBtn.addEventListener('click', () => {
            auth.signOut();
            showNotification(
                currentLanguage === 'sinhala' ? '‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∂¥‡∑í‡∂ß‡∑Ä‡∑í‡∂∫!' : 'Successfully logged out!',
                'success'
            );
        });

        // Theme switching
        function switchTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('neura-theme', theme);
            
            const content = languageContent[currentLanguage];
            themeLabel.textContent = theme === 'dark' ? content.themeLabelDark : content.themeLabelLight;
        }

        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            const content = languageContent[lang];
            
            // Update all text content
            document.getElementById('authTitle').textContent = content.authTitle;
            document.getElementById('authSubtitle').textContent = content.authSubtitle;
            document.getElementById('emailLabel').textContent = content.emailLabel;
            document.getElementById('passwordLabel').textContent = content.passwordLabel;
            document.getElementById('nameLabel').textContent = content.nameLabel;
            document.getElementById('signupEmailLabel').textContent = content.emailLabel;
            document.getElementById('signupPasswordLabel').textContent = content.passwordLabel;
            document.getElementById('confirmPasswordLabel').textContent = content.confirmPasswordLabel;
            document.getElementById('loginButton').textContent = content.loginButton;
            document.getElementById('signupButton').textContent = content.signupButton;
            document.getElementById('noAccount').textContent = content.noAccount;
            document.getElementById('haveAccount').textContent = content.haveAccount;
            document.getElementById('showSignup').textContent = content.showSignup;
            document.getElementById('showLogin').textContent = content.showLogin;
            document.getElementById('forgotPassword').textContent = content.forgotPassword;
            document.getElementById('resetPasswordButton').textContent = content.resetPasswordButton;
            document.getElementById('backToLogin').textContent = content.backToLogin;
            
            document.getElementById('logoTitle').textContent = content.logoTitle;
            document.getElementById('headerSubtitle').textContent = content.headerSubtitle;
            document.getElementById('username').textContent = content.username;
            document.getElementById('userStatus').textContent = content.userStatus;
            document.getElementById('statusText').textContent = content.statusText;
            document.getElementById('logoutText').textContent = content.logoutText;
            document.getElementById('welcomeTitle').textContent = content.welcomeTitle;
            document.getElementById('welcomeText').innerHTML = content.welcomeText;
            document.getElementById('typingText').textContent = content.typingText;
            document.getElementById('messageInput').placeholder = content.inputPlaceholder;
            document.getElementById('clearChatText').textContent = content.clearChatText;
            document.getElementById('exportChatText').textContent = content.exportChatText;
            document.getElementById('suggestionsText').textContent = content.suggestionsText;
            document.getElementById('copyrightText').textContent = content.copyright;
            document.getElementById('designCredit').textContent = content.designCredit;
            document.getElementById('footerCopyright').textContent = content.copyright;
            document.getElementById('footerDesign').textContent = content.designCredit;
            
            themeLabel.textContent = currentTheme === 'dark' ? content.themeLabelDark : content.themeLabelLight;
            
            if (lang === 'sinhala') {
                sinhalaBtn.classList.add('active');
                englishBtn.classList.remove('active');
            } else {
                englishBtn.classList.add('active');
                sinhalaBtn.classList.remove('active');
            }
            
            localStorage.setItem('neura-language', lang);
        }

        // Load saved preferences
        const savedTheme = localStorage.getItem('neura-theme') || 'dark';
        const savedLanguage = localStorage.getItem('neura-language') || 'sinhala';

        switchTheme(savedTheme);
        switchLanguage(savedLanguage);

        if (savedTheme === 'light') {
            themeToggle.checked = true;
        }

        // Event listeners
        themeToggle.addEventListener('change', function() {
            switchTheme(this.checked ? 'light' : 'dark');
        });

        sinhalaBtn.addEventListener('click', () => switchLanguage('sinhala'));
        englishBtn.addEventListener('click', () => switchLanguage('english'));

        // Chat functionality
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        function addMessage(message, isUser) {
            const welcomeMsg = chatMessages.querySelector('.welcome-message');
            if (welcomeMsg) {
                welcomeMsg.remove();
            }
            
            const content = languageContent[currentLanguage];
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(isUser ? 'user-message' : 'ai-message');
            
            const messageHeader = document.createElement('div');
            messageHeader.classList.add('message-header');
            messageHeader.innerHTML = isUser ? 
                `<div class="message-avatar"><i class="fas fa-user"></i></div> ${content.userLabel}` : 
                `<div class="message-avatar"><i class="fas fa-robot"></i></div> ${content.aiLabel}`;
            
            const messageContent = document.createElement('div');
            messageContent.classList.add('message-content');
            messageContent.innerHTML = message.replace(/\n/g, '<br>');
            
            const messageTime = document.createElement('div');
            messageTime.classList.add('message-time');
            messageTime.textContent = new Date().toLocaleTimeString();
            
            // Add message actions for AI messages
            if (!isUser) {
                const messageActions = document.createElement('div');
                messageActions.classList.add('message-actions');
                
                const copyBtn = document.createElement('button');
                copyBtn.classList.add('message-action-btn');
                copyBtn.innerHTML = '<i class="fas fa-copy"></i> ' + (currentLanguage === 'sinhala' ? '‡∂¥‡∑í‡∂ß‡∂¥‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±' : 'Copy');
                copyBtn.addEventListener('click', function() {
                    navigator.clipboard.writeText(message).then(() => {
                        showNotification(
                            currentLanguage === 'sinhala' ? '‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂¥‡∑í‡∂ß‡∂¥‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì' : 'Response copied to clipboard',
                            'success'
                        );
                    });
                });
                
                messageActions.appendChild(copyBtn);
                messageDiv.appendChild(messageActions);
            }
            
            messageDiv.appendChild(messageHeader);
            messageDiv.appendChild(messageContent);
            messageDiv.appendChild(messageTime);
            
            chatMessages.appendChild(messageDiv);
            
            // Add to chat history
            chatHistory.push({
                content: message,
                isUser: isUser,
                timestamp: new Date().toISOString()
            });
            
            // Scroll to bottom
            setTimeout(() => {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 100);
        }

        // Gemini API Integration
        async function getAIResponse(userMessage) {
            try {
                const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GOOGLE_AI_API_KEY}`;
                
                const languagePrompt = currentLanguage === 'sinhala' ? 
                    "‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂¥‡∂∏‡∂´‡∂ö‡∑ä ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±. ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª ‡∑É‡∂ª‡∂Ω ‡∑Ñ‡∑è ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í ‡∑Ä‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∫. ‡∂∏‡∑è‡∂±‡∑Ä ‡∂Ü‡∂ö‡∑è‡∂ª‡∂∫‡∑ö ‡∑É‡∑ä‡∑Ä‡∂∑‡∑è‡∑Ä‡∑í‡∂ö ‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±." : 
                    "Please respond in English only. Keep the response clear, concise and use natural conversational language.";
                
                const prompt = `${userMessage}\n\n${languagePrompt}`;
                
                const requestBody = {
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1024,
                    }
                };
                
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                    throw new Error('Invalid response format from Gemini API');
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                return currentLanguage === 'sinhala' ? 
                    "‡∂ö‡∂´‡∂ú‡∑è‡∂ß‡∑î‡∂∫‡∑í, ‡∂Ø‡∑ù‡∑Ç‡∂∫‡∂ö‡∑ä ‡∂á‡∂≠‡∑í ‡∑Ä‡∑í‡∂∫. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂¥‡∑É‡∑î‡∑Ä ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂ã‡∂≠‡∑ä‡∑É‡∑è‡∑Ñ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±." : 
                    "Sorry, an error occurred. Please try again later.";
            }
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (message === '') return;
            
            addMessage(message, true);
            messageInput.value = '';
            messageInput.style.height = 'auto';
            
            sendButton.disabled = true;
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            try {
                const response = await getAIResponse(message);
                typingIndicator.style.display = 'none';
                addMessage(response, false);
            } catch (error) {
                typingIndicator.style.display = 'none';
                const errorMessage = currentLanguage === 'sinhala' ? 
                    "‡∂ö‡∂´‡∂ú‡∑è‡∂ß‡∑î‡∂∫‡∑í, ‡∂Ø‡∑ù‡∑Ç‡∂∫‡∂ö‡∑ä ‡∂á‡∂≠‡∑í ‡∑Ä‡∑í‡∂∫. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂¥‡∑É‡∑î‡∑Ä ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂ã‡∂≠‡∑ä‡∑É‡∑è‡∑Ñ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±." : 
                    "Sorry, an error occurred. Please try again later.";
                addMessage(errorMessage, false);
            } finally {
                sendButton.disabled = false;
                messageInput.focus();
            }
        }

        sendButton.addEventListener('click', sendMessage);

        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Clear chat function
        clearChatBtn.addEventListener('click', function() {
            if (chatMessages.querySelectorAll('.message').length > 0 || chatMessages.querySelector('.welcome-message')) {
                chatMessages.innerHTML = '';
                chatHistory = [];
                
                const welcomeMsg = document.createElement('div');
                welcomeMsg.classList.add('welcome-message');
                welcomeMsg.innerHTML = `
                    <div class="welcome-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <h2 id="welcome-title">${languageContent[currentLanguage].welcomeTitle}</h2>
                    <p id="welcome-text">${languageContent[currentLanguage].welcomeText}</p>
                    <div class="feature-buttons">
                        <button class="feature-btn" id="clearChatBtn">
                            <i class="fas fa-trash"></i>
                            <span id="clear-chat-text">${languageContent[currentLanguage].clearChatText}</span>
                        </button>
                        <button class="feature-btn" id="exportChatBtn">
                            <i class="fas fa-download"></i>
                            <span id="export-chat-text">${languageContent[currentLanguage].exportChatText}</span>
                        </button>
                        <button class="feature-btn" id="suggestionsBtn">
                            <i class="fas fa-lightbulb"></i>
                            <span id="suggestions-text">${languageContent[currentLanguage].suggestionsText}</span>
                        </button>
                    </div>
                `;
                
                chatMessages.appendChild(welcomeMsg);
                
                showNotification(
                    currentLanguage === 'sinhala' ? '‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø‡∂∫ ‡∑Ñ‡∑í‡∑É‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì' : 'Chat cleared successfully',
                    'success'
                );
            }
        });

        // Export chat function
        exportChatBtn.addEventListener('click', function() {
            if (chatHistory.length === 0) {
                showNotification(
                    currentLanguage === 'sinhala' ? '‡∂Ö‡∂¥ export ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß ‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø‡∂∫‡∂ö‡∑ä ‡∂±‡∑ú‡∂∏‡∑ê‡∂≠' : 'No chat history to export',
                    'warning'
                );
                return;
            }
            
            let chatText = `Smart AI Chat Export - ${new Date().toLocaleString()}\n\n`;
            
            chatHistory.forEach(msg => {
                const sender = msg.isUser ? (currentLanguage === 'sinhala' ? '‡∂î‡∂∂' : 'You') : 'Smart AI';
                chatText += `${sender}: ${msg.content}\n\n`;
            });
            
            const blob = new Blob([chatText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `neura-chat-${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification(
                currentLanguage === 'sinhala' ? '‡∑É‡∂Ç‡∑Ä‡∑è‡∂Ø‡∂∫ ‡∂∂‡∑è‡∂ú‡∂≠ ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì' : 'Chat exported successfully',
                'success'
            );
        });

        // Suggestions function
        suggestionsBtn.addEventListener('click', function() {
            const suggestions = currentLanguage === 'sinhala' ? [
                "AI ‡∂ú‡∑ê‡∂± ‡∂∏‡∂ß ‡∂≠‡∑Ä ‡∂Ø‡∑ê‡∂±‡∂ú‡∂±‡∑ä‡∂± ‡∂ï‡∂±",
                "‡∂ö‡∑ú‡∑Ñ‡∑ú‡∂∏‡∂Ø ‡∂ö‡∑ö‡∂≠‡∂∫‡∂ö‡∑ä ‡∂Ω‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö?",
                "‡∂∏‡∂ß ‡∂ã‡∂Ø‡∑Ä‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∑Ä‡∂ª‡∑ä‡∂≠‡∂∏‡∑è‡∂± ‡∂≠‡∑è‡∂ö‡∑ä‡∑Ç‡∂´ ‡∂¥‡∑ä‚Äç‡∂ª‡∑Ä‡∂´‡∂≠‡∑è ‡∂ú‡∑ê‡∂±",
                "‡∂∏‡∂ß ‡∂â‡∂ú‡∑ô‡∂± ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏‡∂ß ‡∑Ñ‡∑ú‡∂≥‡∂∏ ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏‡∂∫ ‡∂ö‡∑î‡∂∏‡∂ö‡∑ä‡∂Ø?"
            ] : [
                "Tell me more about AI",
                "How do I write code?",
                "Help me with current technology trends",
                "What's the best way to learn?"
            ];
            
            const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
            messageInput.value = randomSuggestion;
            messageInput.focus();
            messageInput.style.height = 'auto';
            messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
            
            showNotification(
                currentLanguage === 'sinhala' ? '‡∂∫‡∑ù‡∂¢‡∂±‡∑è‡∑Ä‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∂Ω‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì' : 'Suggestion added to input',
                'success'
            );
        });

        // Enter key for form submission
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const activeForm = document.querySelector('.auth-form[style*="display: flex"]');
                if (activeForm) {
                    const submitButton = activeForm.querySelector('.auth-button');
                    if (submitButton) {
                        submitButton.click();
                    }
                }
            }
        });

        // Initialize chat input height
        messageInput.style.height = 'auto';
        messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
    </script>
</body>
</html>
